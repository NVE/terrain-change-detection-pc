# Drone Scanning Data Configuration Profile
#
# This profile is optimized for processing drone-scanned point cloud data.
# Drone data characteristics:
# - Files already contain only ground-classified points
# - Smaller file sizes compared to hoydedata.no datasets
# - Flat directory structure with date-location filenames
# - Format: YYYY-MM-DD Location_ground.las

paths:
  # Base directory containing area subdirectories
  # Expected structure: base_dir/area/time_period/*.las
  # Example: data/drone_scanning_data/jeksla/2024-12-03/file.las
  #          data/drone_scanning_data/jeksla/2025-01-15/file.las
  # NOTE: base_dir should point to the parent of area folders, NOT to an area folder itself
  base_dir: data/drone_scanning_data

preprocessing:
  # Drone data is already ground-classified
  ground_only: true
  classification_filter: [2]

discovery:
  # Set to 'drone' for area/time_period/*.laz structure (no 'data' subdirectory)
  source_type: drone
  # data_dir_name and metadata_dir_name are ignored when source_type: drone
  data_dir_name: data
  metadata_dir_name: metadata

alignment:
  # ICP/registration parameters - may need adjustment for drone data
  max_iterations: 100
  tolerance: 1.0e-6
  max_correspondence_distance: 2.0  # Slightly larger for drone data
  subsample_size: 50000
  convergence_translation_epsilon: 1.0e-4
  convergence_rotation_epsilon_deg: 0.1
  coarse:
    enabled: true
    method: phase
    voxel_size: 1.0  # Finer resolution for smaller areas
    phase_grid_cell: 1.0

detection:
  dod:
    enabled: true
    cell_size: 0.5  # Finer grid for potentially higher-resolution drone data
    aggregator: mean
  c2c:
    enabled: false
    mode: euclidean
    max_points: 5000000
    max_distance: null
    radius: null
    k_neighbors: 20
    min_neighbors: 6
  m3c2:
    enabled: false
    use_autotune: true
    # Percentage of reference ground points to use as M3C2 core points
    core_points_percent: 10.0
    autotune:
      source: header
      target_neighbors: 16
      max_depth_factor: 0.6
      min_radius: 0.5  # Smaller radius for higher-resolution data
      max_radius: 10.0
    fixed:
      radius: null
      normal_scale: null
      depth_factor: null
    ep:
      workers: null

visualization:
  backend: pyvista
  sample_size: 50000

logging:
  level: INFO
  file: null

performance:
  numpy_threads: auto

# Drone data is typically small enough for in-memory processing
outofcore:
  enabled: false
